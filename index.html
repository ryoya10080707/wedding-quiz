<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>çµå©šå¼ è¬è§£ããƒãƒ£ãƒ¬ãƒ³ã‚¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap');
    body { font-family: 'Kosugi Maru', sans-serif; text-align: center; padding: 20px; background: linear-gradient(120deg, #ffe4e1, #fff0f5); min-height: 100vh; overflow-x: hidden; position: relative; }
    h1 { color:#d4556f; font-size:26px; margin-bottom:15px; text-shadow:1px 1px #fff;}
    p { font-size:16px; color:#555; margin-bottom:15px; }
    input, button { padding:14px; font-size:18px; margin:8px 0; width:90%; max-width:320px; border-radius:12px; border:2px solid #d4556f; box-sizing:border-box; transition:0.3s; }
    input:focus { outline:none; border-color:#f080a0; }
    button { background-color:#d4556f; color:white; border:none; cursor:pointer; transform-origin:center; }
    button:hover { transform:scale(1.05); background-color:#c04460; }
    .result { margin-top:20px; font-size:22px; font-weight:bold; min-height:28px; word-wrap:break-word; transition: transform 0.3s, color 0.3s; }
    .radio-group { margin:10px 0; }
    .radio-group label { margin:0 10px; font-size:16px; }
    .extra-msg { margin-top:10px; font-size:16px; color:#444; }

    .sparkle { position:absolute; width:4px; height:4px; background:white; border-radius:50%; opacity:0.8; animation:sparkleAnim 3s linear infinite; }
    @keyframes sparkleAnim { 0% {transform:translateY(0) scale(1); opacity:0.8;} 50% {opacity:0.3;} 100% {transform:translateY(600px) scale(0.5); opacity:0;} }

    /* ä»™äººã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç›®ç«‹ãŸãªã„å ´æ‰€ã«å¸¸é§ï¼‰ */
    #sennin { position: fixed; width: 64px; height: auto; bottom: 18px; right: 18px; opacity: 0.68; border-radius: 8px; cursor: pointer; z-index: 9999; transition: transform 0.18s ease, opacity 0.18s; box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
    #sennin:hover { transform: scale(1.06); opacity: 1; }

    /* å°ã•ã„ç”»é¢ã§ã¯ã•ã‚‰ã«å°ã•ã */
    @media (max-width:420px){ #sennin{ width:52px; bottom:12px; right:12px; } }
  </style>
</head>
<body>
  <h1>ğŸ’ çµå©šå¼ è¬è§£ããƒãƒ£ãƒ¬ãƒ³ã‚¸ ğŸ’</h1>
  <p>ãŠåå‰ã¨ç­”ãˆã€ãã—ã¦æ–°éƒå´ã‹æ–°å©¦å´ã‹ã‚’é¸ã‚“ã§ãã ã•ã„</p>
  <input type="text" id="name" placeholder="ãŠåå‰"><br>
  <input type="text" id="answer" placeholder="ç­”ãˆ"><br>
  <div class="radio-group">
    <label><input type="radio" name="side" value="æ–°éƒå´"> æ–°éƒå´</label>
    <label><input type="radio" name="side" value="æ–°å©¦å´"> æ–°å©¦å´</label>
  </div>
  <button onclick="checkAnswer()">ğŸ‰ é€ä¿¡ ğŸ‰</button>
  <div class="result" id="result"></div>
  <div class="extra-msg" id="extraMsg"></div>

  <!-- ç›®ç«‹ãŸãªã„å ´æ‰€ã«ç½®ãä»™äººã‚¢ã‚¤ã‚³ãƒ³ã€‚ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åã¯åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã® sennin.png ã‚’æƒ³å®š -->
  <img id="sennin" src="sennin.png" alt="è¬è§£ãä»™äºº" title="ã‚¿ãƒƒãƒ—ã§è¬è§£ãæŒ‡å—æ›¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰">

  <script>
    // æ­£ç­”ãƒªã‚¹ãƒˆï¼ˆå¿…è¦ã«å¿œã˜ã¦å¢—ã‚„ã™ï¼‰
    const correctAnswers = ["èŠ±å ã„","ãƒãƒŠã‚¦ãƒ©ãƒŠã‚¤","ã¯ãªã†ã‚‰ãªã„","èŠ±ã†ã‚‰ãªã„","ã¯ãªå ã„"];

    function checkAnswer(){
      const name = document.getElementById("name").value.trim();
      const answer = document.getElementById("answer").value.trim();
      const side = document.querySelector('input[name="side"]:checked')?.value;
      const resultDiv = document.getElementById("result");
      const extraMsg = document.getElementById("extraMsg");
      extraMsg.textContent = "";

      if(!name || !answer || !side){
        resultDiv.textContent = "åå‰ãƒ»ç­”ãˆãƒ»æ–°éƒå´/æ–°å©¦å´ã‚’é¸æŠã—ã¦ãã ã•ã„";
        resultDiv.style.color = "orange";
        return;
      }

      const normalized = answer.replace(/\s+/g,"").toLowerCase();
      const isCorrect = correctAnswers.some(ans => ans.replace(/\s+/g,"").toLowerCase() === normalized);

      if(isCorrect){
        resultDiv.textContent = `ğŸ‰ ${name} ã•ã‚“æ­£è§£ï¼ãŠã‚ã§ã¨ã†ï¼`;
        resultDiv.style.color = "green";
        extraMsg.textContent = "âœ… ã‚²ã‚¹ãƒˆæƒ…å ±ãŒæ–°éƒæ–°å©¦ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸ";
        animateResult();
        sendToGoogleForm(name, answer, side); // æ—¢å­˜ã®ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ï¼ˆGoogleãƒ•ã‚©ãƒ¼ãƒ IDã‚’å·®ã—æ›¿ãˆã¦ãã ã•ã„ï¼‰
      } else {
        resultDiv.textContent = "âŒ ä¸æ­£è§£ã§ã™ã€‚ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã¦ã­ã€‚";
        resultDiv.style.color = "red";
      }
    }

    function animateResult(){
      const resultDiv = document.getElementById("result");
      resultDiv.animate([{ transform: "scale(1.2)", color: resultDiv.style.color }, { transform: "scale(1)" }], { duration: 600, easing: "ease-out" });
    }

    function sendToGoogleForm(name, answer, side){
      // Googleãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å…ˆã¯å®Ÿéš›ã® formResponse URL ã¨ entry.xxxxx ã‚’ç½®ãæ›ãˆã¦ãã ã•ã„
      const formURL = "https://docs.google.com/forms/d/e/ã€Googleãƒ•ã‚©ãƒ¼ãƒ IDã€‘/formResponse";
      const formData = new FormData();
      formData.append("entry.1234567890", name);
      formData.append("entry.0987654321", answer);
      formData.append("entry.1122334455", side);
      fetch(formURL, { method: "POST", body: formData })
        .then(() => console.log("æ­£è§£è€…æƒ…å ±ã‚’é€ä¿¡"))
        .catch(() => console.error("é€ä¿¡å¤±æ•—"));
    }

    // PDF ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€‚PDFãƒ•ã‚¡ã‚¤ãƒ«ã¯åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã® guide.pdf ã‚’æƒ³å®šã€‚
    async function downloadPDF(path, filename){
      try{
        // fetch -> blob -> download ã®æµã‚Œï¼ˆåŒä¸€ã‚ªãƒªã‚¸ãƒ³ãªã‚‰å‹•ä½œï¼‰ã€‚
        const response = await fetch(path);
        if(!response.ok){
          // fetch ãŒå¤±æ•—ã—ãŸã‚‰æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
          window.open(path, '_blank');
          return;
        }
        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      }catch(e){
        // Safari / iOS ç­‰ã§ fetch ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        window.open(path, '_blank');
      }
    }

    // ä»™äººã‚¯ãƒªãƒƒã‚¯ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    document.getElementById('sennin').addEventListener('click', function(){
      // ãƒ•ã‚¡ã‚¤ãƒ«åã¯å¿…è¦ã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ãã ã•ã„
      downloadPDF('guide.pdf', 'è¬è§£ãæŒ‡å—æ›¸.pdf');
    });

    // èƒŒæ™¯ã‚­ãƒ©ã‚­ãƒ©
    for(let i=0;i<50;i++){
      const sparkle=document.createElement('div');
      sparkle.className='sparkle';
      sparkle.style.left=Math.random()*window.innerWidth+'px';
      sparkle.style.top=Math.random()*window.innerHeight+'px';
      sparkle.style.animationDuration=(2+Math.random()*3)+'s';
      document.body.appendChild(sparkle);
    }
  </script>
</body>
</html>
